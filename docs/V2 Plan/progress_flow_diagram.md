# ğŸ“Š Student Progress Capture Flow - Visual Guide

## ğŸ”„ Complete System Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     STUDENT INTERACTION                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 1: Student Opens Question                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚   Question: "Find derivative of (xÂ²+1)Â³"                                â”‚
â”‚   Type: Subjective                                                      â”‚
â”‚   Tags: ["chain_rule", "differentiation", "composite_functions"]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 2: Student Answers (Multiple Ways)                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚                                                                          â”‚
â”‚   MCQ:            â†’ Radio button selected: "6x(xÂ²+1)Â²"                  â”‚
â”‚   Subjective:     â†’ Text input: "6x(xÂ²+1)Â²"                            â”‚
â”‚   Match Following:â†’ Drag pairs: [(term, definition)]                    â”‚
â”‚   Fill Blank:     â†’ Enter text: "6x(xÂ²+1)Â²"                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 3: Submit Answer (Frontend)                                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚                                                                          â”‚
â”‚   POST /api/student-progress/attempts                                   â”‚
â”‚   {                                                                      â”‚
â”‚     student_id: "s123",                                                  â”‚
â”‚     question_id: "q456",                                                 â”‚
â”‚     selected_answer: "6x(xÂ²+1)Â²",                                       â”‚
â”‚     time_taken: 45,                                                      â”‚
â”‚     attempts_count: 1,                                                   â”‚
â”‚     hints_used: 0                                                        â”‚
â”‚   }                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 4: API Processing                                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚                                                                          â”‚
â”‚   1. Fetch question details                                             â”‚
â”‚      SELECT tags, correct_answer, question_type                         â”‚
â”‚      FROM question_bank WHERE id = 'q456'                               â”‚
â”‚                                                                          â”‚
â”‚   2. Calculate correctness                                              â”‚
â”‚      - MCQ: Direct comparison                                            â”‚
â”‚      - Subjective: AI grading or fuzzy match                            â”‚
â”‚      - Match: Partial credit per pair                                   â”‚
â”‚                                                                          â”‚
â”‚   3. Determine score                                                     â”‚
â”‚      is_correct = true                                                   â”‚
â”‚      score = 1.0                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 5: Store Attempt (Database)                                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚                                                                          â”‚
â”‚   INSERT INTO student_question_attempts                                â”‚
â”‚   VALUES (                                                               â”‚
â”‚     student_id: 's123',                                                  â”‚
â”‚     question_id: 'q456',                                                 â”‚
â”‚     selected_answer: {'text': '6x(xÂ²+1)Â²'},                             â”‚
â”‚     is_correct: true,                                                    â”‚
â”‚     score: 1.0,                                                          â”‚
â”‚     time_taken_seconds: 45,                                             â”‚
â”‚     attempts_count: 1,                                                  â”‚
â”‚     tags: ['chain_rule', 'differentiation', 'composite_functions']      â”‚
â”‚   )                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 6: Auto-Update Tag Mastery (Trigger)                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚                                                                          â”‚
â”‚   FOR EACH tag IN ['chain_rule', 'differentiation', 'composite_...]:   â”‚
â”‚                                                                          â”‚
â”‚   UPSERT student_tag_mastery                                           â”‚
â”‚   SET:                                                                   â”‚
â”‚     - total_attempts++                                                   â”‚
â”‚     - correct_attempts++ (if correct)                                    â”‚
â”‚     - mastery_score = correct / total                                   â”‚
â”‚     - avg_time = (old_avg Ã— old_total + new_time) / new_total           â”‚
â”‚                                                                          â”‚
â”‚   Result:                                                               â”‚
â”‚     chain_rule: mastery = 0.85 (was 0.75)                              â”‚
â”‚     differentiation: mastery = 0.92                                     â”‚
â”‚     composite_functions: mastery = 0.65                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 7: Query Aggregation (For Display)                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚                                                                          â”‚
â”‚   SELECT tag_name, mastery_score, total_attempts                       â”‚
â”‚   FROM student_tag_mastery                                              â”‚
â”‚   WHERE student_id = 's123'                                             â”‚
â”‚                                                                          â”‚
â”‚   Returns:                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚ Tag Name            â”‚ Mastery      â”‚ Attempts      â”‚               â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚   â”‚ chain_rule          â”‚ 0.85 ğŸŸ¢      â”‚ 12            â”‚               â”‚
â”‚   â”‚ differentiation     â”‚ 0.92 ğŸŸ¢      â”‚ 8             â”‚               â”‚
â”‚   â”‚ composite_functions  â”‚ 0.65 ğŸŸ¡      â”‚ 5             â”‚               â”‚
â”‚   â”‚ implicit_diff       â”‚ 0.42 ğŸ”´      â”‚ 3             â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 8: Display Heatmap (Frontend)                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ ğŸ“Š Tag Mastery Dashboard                              â”‚            â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚   â”‚                                                       â”‚            â”‚
â”‚   â”‚ ğŸŸ¢ chain_rule (85%)         ğŸŸ¢ differentiation (92%)â”‚            â”‚
â”‚   â”‚ ğŸŸ¡ composite_functions (65%) ğŸ”´ implicit_diff (42%) â”‚            â”‚
â”‚   â”‚                                                       â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   STEP 9: Recommend Next Questions                                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚                                                                          â”‚
â”‚   Query:                                                                â”‚
â”‚   SELECT question_id FROM question_bank                                 â”‚
â”‚   WHERE tags && (                                                       â”‚
â”‚     SELECT tag_name FROM student_tag_mastery                           â”‚
â”‚     WHERE student_id = 's123'                                          â”‚
â”‚       AND mastery_score < 0.7  -- Weak tags                            â”‚
â”‚     ORDER BY mastery_score ASC                                         â”‚
â”‚     LIMIT 5                                                             â”‚
â”‚   )                                                                      â”‚
â”‚   LIMIT 3                                                               â”‚
â”‚                                                                          â”‚
â”‚   Next questions suggested:                                             â”‚
â”‚   1. Question on "composite_functions" (difficulty 6)                    â”‚
â”‚   2. Question on "implicit_diff" (difficulty 4)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Components Explained

### 1. Answer Capture (Flexible)

```
Question Type         Answer Format              Validation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
MCQ                   "A" or "B"                 Exact match
Subjective            "6x(xÂ²+1)Â²"                Fuzzy/AI grading
Match Following        [{a: "term1", b: "def1"}] Partial credit per match
Fill Blank            "answer text"              Exact/fuzzy
True/False            true/false                 Boolean
```

### 2. Score Calculation

```
Type                Scoring Method
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
MCQ                 Binary: 1.0 (correct) or 0.0
Match Following     Partial: correct_pairs / total_pairs
Subjective          AI/Manual: 0.0 to 1.0
Fill Blank          Exact: 1.0, Fuzzy: 0.5-0.9
```

### 3. Tag Aggregation Formula

```
For each tag in question.tags:
  mastery_score = correct_attempts / total_attempts
  avg_time = sum(times) / total_attempts

  RYG Status:
    ğŸ”´ < 0.5: Red    â†’ Needs re-teaching
    ğŸŸ¡ 0.5-0.8: Yellow â†’ Keep practicing
    ğŸŸ¢ > 0.8: Green   â†’ Mastered
```

---

## ğŸ’¡ Example: Complete Walkthrough

### Scenario

**Student:** Sarah  
**Question:** "Find derivative of sinÂ²(x)"  
**Expected Answer:** "2sin(x)cos(x) = sin(2x)"  
**Tags:** ["trigonometry", "chain_rule", "identities"]

### Flow

**1. Sarah opens question**

- Timer starts
- Question loads: "Find derivative of sinÂ²(x)"
- Tags: ["trigonometry", "chain_rule", "identities"]

**2. Sarah answers**

- Time: 2 minutes 15 seconds (135 seconds)
- Answer: "2sin(x)cos(x)"

**3. System evaluates**

```javascript
is_correct = checkAnswer(student_answer, expected_answer);
score = is_correct ? 1.0 : 0.0; // Result: 1.0
```

**4. Store attempt**

```sql
INSERT INTO student_question_attempts (
  student_id: 'sarah-uuid',
  question_id: 'q789',
  selected_answer: '2sin(x)cos(x)',
  is_correct: true,
  score: 1.0,
  time_taken_seconds: 135,
  tags: ['trigonometry', 'chain_rule', 'identities']
);
```

**5. Update mastery (automatically via trigger)**

```sql
-- For 'trigonometry' tag:
UPDATE student_tag_mastery
SET total_attempts = total_attempts + 1,
    correct_attempts = correct_attempts + 1,
    mastery_score = (correct_attempts + 1) / (total_attempts + 1)
WHERE student_id = 'sarah-uuid' AND tag_name = 'trigonometry';
```

**6. Result**

- trigonometry: 0.75 â†’ 0.80 ğŸŸ¢ (Mastered!)
- chain_rule: 0.82 â†’ 0.83 ğŸŸ¢ (Already strong)
- identities: 0.68 â†’ 0.70 ğŸŸ¡ (Improved, keep practicing)

**7. Heatmap updated** (reflects new mastery)

**8. Next recommendation**

- System sees "identities" at 0.70 (ğŸŸ¡)
- Recommends: "Simplify sin(3x)cos(x) using identities"

---

## ğŸ” Advanced Analytics

### Retention Tracking

```sql
-- Find questions attempted > 7 days ago
SELECT tag_name,
       COUNT(*) as later_attempts,
       AVG(score) as retention_score
FROM student_question_attempts
WHERE student_id = 's123'
  AND created_at < NOW() - INTERVAL '7 days'
GROUP BY tag_name;
```

### Stamina Detection

```sql
-- Compare accuracy early vs late in session
WITH session_analysis AS (
  SELECT session_id,
         AVG(score) FILTER (WHERE attempt_order <= 5) as early_accuracy,
         AVG(score) FILTER (WHERE attempt_order > 5) as late_accuracy
  FROM student_question_attempts
  WHERE session_id IS NOT NULL
  GROUP BY session_id
)
SELECT
  session_id,
  late_accuracy - early_accuracy as stamina_drop
FROM session_analysis;
```

---

## âœ… Summary

1. **Capture:** Every answer, time, attempts
2. **Store:** Raw attempts + metadata in DB
3. **Aggregate:** Auto-calculate mastery per tag
4. **Visualize:** Heatmap with RYG status
5. **Recommend:** Next questions based on weak tags

This creates a complete feedback loop for adaptive learning.
